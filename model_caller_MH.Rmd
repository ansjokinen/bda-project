---
title: "Model Caller"
author: "Markus Henttonen"
date: "1 12 2021"
output: pdf_document
---

```{r, include=FALSE}
library(rstan)
```

```{r}
data <- read.csv('data/clean/weekly/PRSA_Data_Aotizhongxin_20130301-20170228.csv')
series <- ts(data$SO2)
plot(series)
acf(series)
acf(series, type='partial')
```

```{r}
log_series <- log(series)
plot(log_series)
acf(log_series)
acf(log_series, type='partial')
```

```{r}
diff_series <- diff(log_series, lag=12, differences=1)
plot(diff_series)
acf(diff_series)
acf(diff_series, type='partial')
```

```{r, results='hide', warning=FALSE}
data <-list(
  y = diff_series,
  T = length(diff_series),
  N = 1
)
model <- stan(file='test_model_MH.stan', data=data, iter=6000)
df <- as.data.frame(model)
plot(df$alpha, df$'beta[1]', xlab='alpha', ylab='beta', main='Posterior distribution')
```