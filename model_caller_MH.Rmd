---
title: "Model Caller"
author: "Markus Henttonen"
date: "1 12 2021"
output: pdf_document
---

```{r, include=FALSE}
library(rstan)
```

```{r}
data <- read.csv('data/clean/weekly/PRSA_Data_Aotizhongxin_20130301-20170228.csv')
series <- ts(data$SO2, frequency = 52)
plot(series)
acf(series, lag.max = 105)
acf(series, type='partial', lag.max = 105)
```

```{r}
log_series <- log(series)
plot(log_series)
acf(log_series, lag.max = 105)
acf(log_series, type='partial', lag.max = 105)
```

```{r}
diff_series <- diff(log_series, lag=52, differences=1)
plot(diff_series)
acf(diff_series, lag.max = 105)
acf(diff_series, type='partial', lag.max = 105)
```

```{r, results='hide', warning=FALSE}
data <-list(
  y = log_series,
  T = length(log_series),
  N = 1
)
model <- stan(file='test_model_MH.stan', data=data, iter=6000)
df <- as.data.frame(model)
plot(df$phi, df$theta, xlab='alpha', ylab='beta', main='Posterior distribution')
```





```{r}
plot(df$phi, df$theta, xlab='alpha', ylab='beta', main='Posterior distribution')

```









































